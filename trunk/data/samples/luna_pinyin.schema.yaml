# Rime schema (draft)
# vim: set sw=2 sts=2 et:
# encoding: utf-8

schema:
  id: luna_pinyin
  name: 朙月拼音
  version: "0.1"
  author:
    - android open-source project
    - 佛振 <chen.sst@gmail.com>
  description: |
    derived from android open-source project.

engine:
  processors: 
    - r10n_composer
    - numeric_composer
    - echo_composer
    - editor
  dictionaries:
    - abc_dict
    - parrot
    - number_formatter

r10n_composer:
  alphabet: "abcdefghijklmnopqrstuvwxyz"
  delimiter: "'"
  auto_commit: y  # 段落确认完毕立即上屏不需按Return确认

editor:
  modal: n
  inline: n
  prompt_cursor_style: ">"
  prompt_highlight_style: "[%s]"
  prompt_ellipsis_style: "..."
  prompt_delimiter_style: " "
  prompt_algebra:
    - [ xlit, "abcdefg", "日月金木水火土" ]  # 显示形码键名用
    - [ xform, "dang1", "da-ng" ]  # 注意：在整個輸入串內做全局替換！

abc_dict:
  vocabulary: luna_pinyin
  spelling_algebra:
    - [ xlit,     "ABCDEFG",        "abcdefg" ]            # 字符轉寫    
    - [ xlit,     "abcdefg",        [ a, be, ce, de, e, ef, ge ] ]
    # 把拼式甲替換為拼式乙
    - [ xform,    "\d$",            "" ]                   # 合併
    - [ xform,    "^zh",            "j" ]                  # 變換
    # 令拼式乙兼表拼式甲，拼式甲繼續有效
    # 字段四：數值，為該拼式的權值
    # 字段五：是否提示原拼式
    - [ alias,    "^sh",            "s",      0.5,    y ]  # 模糊音
    - [ alias,    "^j(.*)$",        "zh\1",   1,      y ]  # 等效拼寫
    - [ alias,    "gn$",            "ng",     0.1,    y ]  # 糾錯
    # 效果類似alias，但僅在無其他切分路徑時生效
    - [ abbr,     "^sh.*$",         "sh",     0.5 ]        # 簡拼
    - [ abbr,     "^(.+)..$",       "\1",     0.1,    y ]  # 逐鍵提示
    # 不標聲調
    - [ xform,    "^(.+)\d$",       "\1" ]
    # 模糊音
    - [ alias,    "^([zcs])h",      "\1",     0.5 ]
    - [ alias,    "^([zcs])([^h])", "\1h\2",  0.5 ]
    - [ alias,    "^l",             "n",      0.5 ]
    - [ alias,    "^n",             "l",      0.5 ]
    - [ alias,    "([ei])ng$",      "\1n",    0.5 ]
    - [ alias,    "([ei])n$",       "\1ng",   0.5 ]
    # 簡拼
    - [ abbr,     "^(.).+$",        "\1",     0.1 ]
    - [ abbr,     "^([zcs]h).+$",   "\1",     0.1 ]
    # 容錯拼寫
    - [ alias,    "^([nl])ue$",     "\1ve" ]
    - [ alias,    "ui$",            "uei",    0.5,    y ]
    - [ alias,    "ui$",            "iou",    0.5,    y ]
    # 糾錯
    - [ alias,    "([aeiou])ng$",   "\1gn",   0.5,    y ]
    - [ alias,    "([iu])([ao])([io]|ng?)$", "\2\1\3", 0.1, y ]
